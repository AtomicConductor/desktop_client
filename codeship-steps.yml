- type: serial
  steps:
    - name: test
      service: conductor
      command: yarn test

    - name: build
      service: conductor
      command: bash -c "yarn build && mv build /release"

    - name: deploy dev
      service: aws
      command: sh -c "aws s3 cp /release/build/conductor s3://${AWS_S3_BUCKET_NAME}/dev/ --recursive"
      exclude: ^(master)

    - name: deploy prod
      service: aws
      command: sh -c "aws s3 cp /release/build/conductor s3://${AWS_S3_BUCKET_NAME}/prod/ --recursive"
      tag: master
    